## mCASH MAPI PoC app

This is a simple app to evaluate mCASH usage within a e-commerce web app.

#### About this version:

A "Donation" app, in which the whole payment cycle with mCASH is implemented.
Each browser session has a shopping cart, which can be "opened", "waiting for payment" (after the QR code scan) or "paid"
(after the user authorization and app capture of the transaction).

#### Ideas for future versions:

* Deal with user payment rejection.
* Retrieving donator personal info (address) from mCASH.
* App user sign-up/sign-in: no more session shopping carts.

#### Running the app:

1. Get the [Heroku Toolbelt](https://toolbelt.heroku.com/).
2. Clone this repo.
3. In the project root, create a virtualenv:
```
$ virtualenv venv
```
4. Activate it:
```
$ source venv/bin/activate
```
5. Install project dependencies:
```
$ pip install -r requirements.txt
```
6. Setup app database, running:
```
$ ./syncdb.sh
$ ./migrate.sh
```
7. Tunnel ngrok to localhost:8000.
8. Create a file named .env in the project root with the following content:
```
MCASH_MERCHANT_ID=iw1yhe
MCASH_USER=thedude
MCASH_USER_SECRET=supersecret
MCASH_TESTBED_TOKEN=A8_0ie3jUVq2TJ252W42L52DbSnZlWHWIsHkMjYWTdE
HOST_DOMAIN=< domain generated by ngrok, eg. 14ce6041.ngrok.com >
```
9. Create a shortlink that points to your app instance:
```
$ ./generate_shortlink.sh
```
10. Append the following line to .env file:
```
MCASH_SHORTLINK_ID=< shortlink id generated in last step >
```
11. Run it:
```
$ ./run.sh
```

[Play with the mCASH testbed.](http://mcashtestbed.appspot.com/testbed/merchant/iw1yhe/login/?token=A8_0ie3jUVq2TJ252W42L52DbSnZlWHWIsHkMjYWTdE)

PS: Tested with QR simulated scanning through the testbed.
Scanning the QR code on mobile has not been tested yet.